{"mappings":"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","sources":["/mnt/c/WebXR/utopic-estudios/node_modules/@parcel/scope-hoisting/lib/helpers.js","node_modules/@parcel/runtime-js/lib/bundle-manifest.js","node_modules/@parcel/runtime-js/lib/JSRuntime.js","node_modules/@parcel/runtime-js/lib/bundle-url.js","node_modules/@parcel/runtime-js/lib/relative-path.js","src/logic/lcdm.js"],"names":["$parcel$interopDefault","a","__esModule","default","mapping","id","resolved","Error","pairs","keys","Object","i","length","$bd72ee1865b930c1fed8ae47f35e91$export$register","JSON","parse","bundleURL","err","matches","stack","match","replace","getBundleURL","resolve","$bd72ee1865b930c1fed8ae47f35e91$export$resolve","dirname","_filePath","filePath","slice","slashIndex","lastIndexOf","relative","from","to","fromParts","split","shift","divergeIndex","toParts","parts","push","apply","join","$e5b69ae2ffddc223b376d75aff9c28$exports","fromId","toId","_dirname","_relative","$aa29e196542441d3d4fcdeda68379c3$exports","$da3a6c17234c5d68d4f1108f53a7bad4$export$getBundleURL","$d34483f6e10afec98bdae67208326c9$exports","$ff6b2a691cd763fe34b72580d82ebdb$exports","$e174cafca36189b8574664065e7784$exports","scene","camera","canvas","renderer","grabPoint","$a324c7ab8680f6ddf3c46fa09ec7367$exports","physicsWorld","clock","line","directionalLight","cubes","interactable","mouse","THREE","Vector2","raycaster","Raycaster","linePositions","cubeSettings","elem","document","querySelector","pos","x","y","z","rot","Euler","texture","$aa29e196542441d3d4fcdeda68379c3$$interop$default","active","$d34483f6e10afec98bdae67208326c9$$interop$default","$ff6b2a691cd763fe34b72580d82ebdb$$interop$default","$e174cafca36189b8574664065e7784$$interop$default","$a324c7ab8680f6ddf3c46fa09ec7367$$interop$default","planElems","querySelectorAll","getGameXY","bounds","window","pageXOffset","pageYOffset","clientWidth","clientHeight","width","height","zoom","updateCubeSettings","curCube","e","getBoundingClientRect","Vector3","createBound","name","depth","color","arguments","undefined","colShape","CANNON","Box","Vec3","body","Body","mass","position","shape","addBody","geometry","BoxBufferGeometry","object","Mesh","MeshBasicMaterial","scale","set","userData","add","removeEntity","selectedObject","getObjectByName","removeBody","remove","CreateBounds","min_x","left","max_x","right","min_y","bottom","max_y","top","w","updateCameraSize","updateProjectionMatrix","updateSize","r","needResize","domElement","setSize","animate","deltaTime","getDelta","time","Date","now","Math","cos","obj","physicsBody","min","max","ClampPositions","constraint","first_time","ga","hitType","eventCategory","eventAction","_v$unproject2","unproject","grabPointPos","setFromMatrixPosition","matrixWorld","attributes","needsUpdate","computeBoundingSphere","visible","dt","gravity","step","objThree","p","q","quaternion","updatePhysics","solved","frame_counter","force","random","v","normalize","multiplyScalar","applyLocalImpulse","fluidsMovePointers","PreparePointers","gameBounds","trySol","cube","sort","b","proposedSol","map","toString","CheckSolution","PlaySolvedMagic","render","requestAnimationFrame","addEventListener","World","quatNormalizeSkip","quatNormalizeFast","broadphase","NaiveBroadphase","allowSleep","jointBody","setupPhysicsWorld","Clock","getElementById","WebGLRenderer","alpha","shadowMap","enabled","type","PCFSoftShadowMap","OrthographicCamera","Scene","AmbientLight","DirectionalLight","castShadow","shadow","clone","near","far","mapSize","lineGeometry","BufferGeometry","Float32Array","setAttribute","BufferAttribute","setDrawRange","Line","LineBasicMaterial","linewidth","input","pixelRatio","devicePixelRatio","floor","createCube","quat","textureUrl","TextureLoader","load","SphereGeometry","config","Quaternion","setFromEuler","size","sleep","domElem","planeMaterial","opacity","transparent","planeGeometry","PlaneBufferGeometry","crystal","createShadowPlane","rotation","ShadowMaterial","plane","copy","receiveShadow","shadowPlane","createAndAddShadowPlanes","lastWidth","innerWidth","RT","clearTimeout","setTimeout","location","reload","onMouseMove","onMouseDown","passive","onMouseCancel","init","pickedBody","intersection","event","updateMouse","updateIntersection","preventDefault","inter","localPoint","worldToLocal","point","localPivot","PointToPointConstraint","addConstraint","parent","removeConstraint","touchEv","touches","changedTouchEv","changedTouches","touch","documentBounds","documentElement","pageX","pageY","nonPageX","clientX","nonPageY","clientY","setFromCamera","newIntersections","intersectObjects","startsWith","style","pointerEvents","cursor","_v$unproject","update","scroll","scrollX","scrollY","solve","cubePointers","identifier","vantabg","destroy","enableFluids","cubesPointers","fluidsStartPointers","burger","classList","contains"],"version":3,"file":"lcdm.003f5222.js.map","sourcesContent":[null,"\"use strict\";\n\nvar mapping = {};\n\nfunction register(pairs) {\n  var keys = Object.keys(pairs);\n\n  for (var i = 0; i < keys.length; i++) {\n    mapping[keys[i]] = pairs[keys[i]];\n  }\n}\n\nfunction resolve(id) {\n  var resolved = mapping[id];\n\n  if (resolved == null) {\n    throw new Error('Could not resolve bundle with id ' + id);\n  }\n\n  return resolved;\n}\n\nmodule.exports.register = register;\nmodule.exports.resolve = resolve;","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _plugin = require(\"@parcel/plugin\");\n\nvar _utils = require(\"@parcel/utils\");\n\nvar _path = _interopRequireDefault(require(\"path\"));\n\nvar _nullthrows = _interopRequireDefault(require(\"nullthrows\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// List of browsers that support dynamic import natively\n// https://caniuse.com/#feat=es6-module-dynamic-import\nconst DYNAMIC_IMPORT_BROWSERS = {\n  edge: '76',\n  firefox: '67',\n  chrome: '63',\n  safari: '11.1',\n  opera: '50'\n};\nconst LOADERS = {\n  browser: {\n    css: './loaders/browser/css-loader',\n    html: './loaders/browser/html-loader',\n    js: './loaders/browser/js-loader',\n    wasm: './loaders/browser/wasm-loader',\n    IMPORT_POLYFILL: './loaders/browser/import-polyfill'\n  },\n  worker: {\n    js: './loaders/worker/js-loader',\n    wasm: './loaders/worker/wasm-loader',\n    IMPORT_POLYFILL: false\n  },\n  node: {\n    css: './loaders/node/css-loader',\n    html: './loaders/node/html-loader',\n    js: './loaders/node/js-loader',\n    wasm: './loaders/node/wasm-loader',\n    IMPORT_POLYFILL: null\n  }\n};\n\nfunction getLoaders(ctx) {\n  if (ctx.isWorker()) return LOADERS.worker;\n  if (ctx.isBrowser()) return LOADERS.browser;\n  if (ctx.isNode()) return LOADERS.node;\n  return null;\n}\n\nvar _default = new _plugin.Runtime({\n  apply({\n    bundle,\n    bundleGraph,\n    options\n  }) {\n    // Dependency ids in code replaced with referenced bundle names\n    // Loader runtime added for bundle groups that don't have a native loader (e.g. HTML/CSS/Worker - isURL?),\n    // and which are not loaded by a parent bundle.\n    // Loaders also added for modules that were moved to a separate bundle because they are a different type\n    // (e.g. WASM, HTML). These should be preloaded prior to the bundle being executed. Replace the entry asset(s)\n    // with the preload module.\n    if (bundle.type !== 'js') {\n      return;\n    }\n\n    let asyncDependencies = [];\n    let otherDependencies = [];\n    bundle.traverse(node => {\n      if (node.type !== 'dependency') {\n        return;\n      }\n\n      let dependency = node.value;\n\n      if (dependency.isAsync && !dependency.isURL) {\n        asyncDependencies.push(dependency);\n      } else {\n        otherDependencies.push(dependency);\n      }\n    });\n    let assets = [];\n\n    for (let dependency of asyncDependencies) {\n      let resolved = bundleGraph.resolveExternalDependency(dependency, bundle);\n\n      if (resolved == null) {\n        continue;\n      }\n\n      if (resolved.type === 'asset') {\n        // If this bundle already has the asset this dependency references,\n        // return a simple runtime of `Promise.resolve(require(\"path/to/asset\"))`.\n        assets.push({\n          filePath: _path.default.join(options.projectRoot, 'JSRuntime.js'),\n          // Using Promise['resolve'] to prevent Parcel from inferring this is an async dependency.\n          // TODO: Find a better way of doing this.\n          code: `module.exports = Promise['resolve'](require(${JSON.stringify('./' + _path.default.relative(options.projectRoot, resolved.value.filePath))}))`,\n          dependency\n        });\n      } else {\n        assets.push(...getLoaderRuntimes({\n          bundle,\n          dependency,\n          bundleGraph,\n          bundleGroup: resolved.value\n        }));\n      }\n    }\n\n    for (let dependency of otherDependencies) {\n      let resolved = bundleGraph.resolveExternalDependency(dependency, bundle);\n\n      if (dependency.isURL && resolved == null) {\n        // If a URL dependency was not able to be resolved, add a runtime that\n        // exports the original moduleSpecifier.\n        assets.push({\n          filePath: __filename,\n          code: `module.exports = ${JSON.stringify(dependency.moduleSpecifier)}`,\n          dependency\n        });\n        continue;\n      }\n\n      if (resolved == null || resolved.type !== 'bundle_group') {\n        continue;\n      }\n\n      let bundleGroup = resolved.value;\n      let mainBundle = (0, _nullthrows.default)(bundleGraph.getBundlesInBundleGroup(bundleGroup).find(b => {\n        let main = b.getMainEntry();\n        return main && bundleGroup.entryAssetId === main.id;\n      }));\n\n      if (mainBundle.isInline) {\n        assets.push({\n          filePath: _path.default.join(__dirname, `/bundles/${mainBundle.id}.js`),\n          code: `module.exports = ${JSON.stringify(dependency.id)};`,\n          dependency\n        });\n        continue;\n      } // URL dependency or not, fall back to including a runtime that exports the url\n\n\n      assets.push(getURLRuntime(dependency, bundle, mainBundle));\n    }\n\n    if (shouldUseRuntimeManifest(bundle) && bundleGraph.getChildBundles(bundle).length > 0 && isNewContext(bundle, bundleGraph)) {\n      assets.push({\n        filePath: __filename,\n        code: getRegisterCode(bundle, bundleGraph),\n        isEntry: true\n      });\n    }\n\n    return assets;\n  }\n\n});\n\nexports.default = _default;\n\nfunction getLoaderRuntimes({\n  bundle,\n  dependency,\n  bundleGroup,\n  bundleGraph\n}) {\n  let assets = []; // Sort so the bundles containing the entry asset appear last\n\n  let externalBundles = bundleGraph.getBundlesInBundleGroup(bundleGroup).filter(bundle => !bundle.isInline).sort(bundle => bundle.getEntryAssets().map(asset => asset.id).includes(bundleGroup.entryAssetId) ? 1 : -1); // CommonJS is a synchronous module system, so there is no need to load bundles in parallel.\n  // Importing of the other bundles will be handled by the bundle group entry.\n  // Do the same thing in library mode for ES modules, as we are building for another bundler\n  // and the imports for sibling bundles will be in the target bundle.\n\n  if (bundle.env.outputFormat === 'commonjs' || bundle.env.isLibrary) {\n    externalBundles = externalBundles.slice(-1);\n  }\n\n  let loaders = getLoaders(bundle.env); // Determine if we need to add a dynamic import() polyfill, or if all target browsers support it natively.\n\n  let needsDynamicImportPolyfill = false;\n\n  if (bundle.env.isBrowser() && bundle.env.outputFormat === 'esmodule') {\n    needsDynamicImportPolyfill = !bundle.env.matchesEngines(DYNAMIC_IMPORT_BROWSERS);\n  }\n\n  let loaderModules = loaders ? externalBundles.map(to => {\n    let loader = loaders[to.type];\n\n    if (!loader) {\n      return;\n    }\n\n    let relativePathExpr = getRelativePathExpr(bundle, to); // Use esmodule loader if possible\n\n    if (to.type === 'js' && to.env.outputFormat === 'esmodule') {\n      if (!needsDynamicImportPolyfill) {\n        return `import(\"./\" + ${relativePathExpr})`;\n      }\n\n      loader = (0, _nullthrows.default)(loaders.IMPORT_POLYFILL, `No import() polyfill available for context '${bundle.env.context}'`);\n    } else if (to.type === 'js' && to.env.outputFormat === 'commonjs') {\n      return `Promise.resolve(require(\"./\" + ${relativePathExpr}))`;\n    }\n\n    return `require(${JSON.stringify(loader)})(require('./bundle-url').getBundleURL() + ${relativePathExpr})`;\n  }).filter(Boolean) : [];\n\n  if (loaderModules.length > 0) {\n    let loaders = loaderModules.join(', ');\n\n    if (loaderModules.length > 1 && (bundle.env.outputFormat === 'global' || !externalBundles.every(b => b.type === 'js'))) {\n      loaders = `Promise.all([${loaders}])`;\n\n      if (bundle.env.outputFormat !== 'global') {\n        loaders += `.then(r => r[r.length - 1])`;\n      }\n    } else {\n      loaders = `(${loaders})`;\n    }\n\n    if (bundle.env.outputFormat === 'global') {\n      loaders += `.then(() => parcelRequire('${bundleGroup.entryAssetId}')${// In global output with scope hoisting, functions return exports are\n      // always returned. Otherwise, the exports are returned.\n      bundle.env.scopeHoist ? '()' : ''})`;\n    }\n\n    assets.push({\n      filePath: __filename,\n      code: `module.exports = ${loaders};`,\n      dependency\n    });\n  }\n\n  return assets;\n}\n\nfunction isNewContext(bundle, bundleGraph) {\n  return bundle.isEntry || bundleGraph.getParentBundles(bundle).some(parent => parent.env.context !== bundle.env.context || parent.type !== 'js');\n}\n\nfunction getURLRuntime(dependency, from, to) {\n  let relativePathExpr = getRelativePathExpr(from, to);\n\n  if (dependency.meta.webworker === true) {\n    return {\n      filePath: __filename,\n      code: `module.exports = require('./get-worker-url')(${relativePathExpr});`,\n      dependency\n    };\n  }\n\n  return {\n    filePath: __filename,\n    code: `module.exports = require('./bundle-url').getBundleURL() + ${relativePathExpr}`,\n    dependency\n  };\n}\n\nfunction getRegisterCode(entryBundle, bundleGraph) {\n  let idToName = {};\n  bundleGraph.traverseBundles((bundle, _, actions) => {\n    if (bundle.isInline) {\n      return;\n    }\n\n    idToName[getPublicBundleId(bundle)] = (0, _nullthrows.default)(bundle.name);\n\n    if (bundle !== entryBundle && isNewContext(bundle, bundleGraph)) {\n      // New contexts have their own manifests, so there's no need to continue.\n      actions.skipChildren();\n    }\n  }, entryBundle);\n  return \"require('./bundle-manifest').register(JSON.parse(\" + JSON.stringify(JSON.stringify(idToName)) + '));';\n}\n\nfunction getRelativePathExpr(from, to) {\n  if (shouldUseRuntimeManifest(from)) {\n    return `require('./relative-path')(${JSON.stringify(getPublicBundleId(from))}, ${JSON.stringify(getPublicBundleId(to))})`;\n  }\n\n  return JSON.stringify((0, _utils.relativeBundlePath)(from, to, {\n    leadingDotSlash: false\n  }));\n}\n\nfunction shouldUseRuntimeManifest(bundle) {\n  let env = bundle.env;\n  return !env.isLibrary && env.outputFormat === 'global' && env.isBrowser();\n}\n\nfunction getPublicBundleId(bundle) {\n  return bundle.id.slice(-16);\n}","\"use strict\";\n\n/* globals document:readonly */\nvar bundleURL = null;\n\nfunction getBundleURLCached() {\n  if (!bundleURL) {\n    bundleURL = getBundleURL();\n  }\n\n  return bundleURL;\n}\n\nfunction getBundleURL() {\n  try {\n    throw new Error();\n  } catch (err) {\n    var matches = ('' + err.stack).match(/(https?|file|ftp):\\/\\/[^)\\n]+/g);\n\n    if (matches) {\n      return getBaseURL(matches[0]);\n    }\n  }\n\n  return '/';\n}\n\nfunction getBaseURL(url) {\n  return ('' + url).replace(/^((?:https?|file|ftp):\\/\\/.+)\\/[^/]+$/, '$1') + '/';\n} // TODO: Replace uses with `new URL(url).origin` when ie11 is no longer supported.\n\n\nfunction getOrigin(url) {\n  let matches = ('' + url).match(/(https?|file|ftp):\\/\\/[^/]+/);\n\n  if (!matches) {\n    throw new Error('Origin not found');\n  }\n\n  return matches[0];\n}\n\nexports.getBundleURL = getBundleURLCached;\nexports.getBaseURL = getBaseURL;\nexports.getOrigin = getOrigin;","\"use strict\";\n\nvar resolve = require('./bundle-manifest').resolve;\n\nmodule.exports = function (fromId, toId) {\n  return relative(dirname(resolve(fromId)), resolve(toId));\n};\n\nfunction dirname(_filePath) {\n  if (_filePath === '') {\n    return '.';\n  }\n\n  var filePath = _filePath[_filePath.length - 1] === '/' ? _filePath.slice(0, _filePath.length - 1) : _filePath;\n  var slashIndex = filePath.lastIndexOf('/');\n  return slashIndex === -1 ? '.' : filePath.slice(0, slashIndex);\n}\n\nfunction relative(from, to) {\n  if (from === to) {\n    return '';\n  }\n\n  var fromParts = from.split('/');\n\n  if (fromParts[0] === '.') {\n    fromParts.shift();\n  }\n\n  var toParts = to.split('/');\n\n  if (toParts[0] === '.') {\n    toParts.shift();\n  } // Find where path segments diverge.\n\n\n  var i;\n  var divergeIndex;\n\n  for (i = 0; (i < toParts.length || i < fromParts.length) && divergeIndex == null; i++) {\n    if (fromParts[i] !== toParts[i]) {\n      divergeIndex = i;\n    }\n  } // If there are segments from \"from\" beyond the point of divergence,\n  // return back up the path to that point using \"..\".\n\n\n  var parts = [];\n\n  for (i = 0; i < fromParts.length - divergeIndex; i++) {\n    parts.push('..');\n  } // If there are segments from \"to\" beyond the point of divergence,\n  // continue using the remaining segments.\n\n\n  if (toParts.length > divergeIndex) {\n    parts.push.apply(parts, toParts.slice(divergeIndex));\n  }\n\n  return parts.join('/');\n}\n\nmodule.exports._dirname = dirname;\nmodule.exports._relative = relative;","import cubeTexture1 from 'url:/img/lcdm/cubes/1.jpg';\r\nimport cubeTexture2 from 'url:/img/lcdm/cubes/2.jpg';\r\nimport cubeTexture3 from 'url:/img/lcdm/cubes/3.jpg';\r\nimport cubeTexture4 from 'url:/img/lcdm/cubes/4.jpg';\r\nimport cubeTexture5 from 'url:/img/lcdm/cubes/5.jpg';\r\n\r\nlet scene , camera, canvas, renderer;\r\nlet grabPoint;\r\nlet cubes = [];\r\nlet interactable = [];\r\n\r\nconst mouse = new THREE.Vector2();\r\nconst raycaster = new THREE.Raycaster();\r\nlet physicsWorld;\r\nlet clock;\r\n\r\nlet linePositions = [0, 0, 0, /**/ 0,0,0];\r\nlet line;\r\n\r\nlet directionalLight;\r\n\r\nconst cubeSettings = [\r\n    {\r\n        elem: document.querySelector('.cube.is-1'),\r\n        pos: {x:0, y: 0, z: 0 },\r\n        rot: new THREE.Euler(30, 0, 0),\r\n        texture: cubeTexture1,\r\n        active: true\r\n    },\r\n    {\r\n        elem: document.querySelector('.cube.is-2'),\r\n        pos: {x:0, y: 0, z: 0 },\r\n        rot: new THREE.Euler(30, 0, 0),\r\n        texture: cubeTexture2,\r\n    },\r\n    {\r\n        elem: document.querySelector('.cube.is-3'),\r\n        pos: {x:0, y: 0, z: 0 },\r\n        rot: new THREE.Euler(30, 0, 0),\r\n        texture: cubeTexture3,\r\n    },\r\n    {\r\n        elem: document.querySelector('.cube.is-4'),\r\n        pos: {x:0, y: 0, z: 0 },\r\n        rot: new THREE.Euler(0, 0, 0),\r\n        texture: cubeTexture4,\r\n    },\r\n    {\r\n        elem: document.querySelector('.cube.is-5'),\r\n        pos: {x:0, y: 0, z: 0 },\r\n        rot: new THREE.Euler(0, 0, 0),\r\n        texture: cubeTexture5,\r\n        active: true\r\n    }\r\n]\r\n\r\nconst planElems = document.querySelectorAll('.shadow-panel');\r\n\r\nwindow.addEventListener('load', start);\r\n\r\nfunction getGameXY(bounds){\r\n    let x = bounds.x;\r\n    let y = bounds.y;\r\n\r\n    //get relative to document\r\n    x += window.pageXOffset;\r\n    y += window.pageYOffset;\r\n\r\n    //get relative to game axis\r\n    x = x + canvas.clientWidth / -2;\r\n    y = ( canvas.clientHeight / 2) - y;\r\n\r\n    //center\r\n    x += bounds.width / 2;\r\n    y -= bounds.height / 2;\r\n\r\n    return {x: x/camera.zoom, y: y/camera.zoom, height: bounds.height / camera.zoom, width: bounds.width / camera.zoom};\r\n}\r\n\r\nfunction updateCubeSettings(){\r\n    for(let i = 0; i < cubeSettings.length; i++){\r\n        const curCube = cubeSettings[i];\r\n        const e = curCube.elem;\r\n        if (!e) continue;\r\n        const bounds = getGameXY(e.getBoundingClientRect());\r\n\r\n        curCube.pos = new THREE.Vector3(bounds.x, bounds.y , 0);\r\n    }\r\n}\r\n\r\nfunction createAndAddCubesContainer(){\r\n    const element = document.querySelector('.puzzle');\r\n    const bounds = element.getBoundingClientRect();\r\n    const gameBounds = getGameXY(bounds);\r\n\r\n    const min_x = gameBounds.x;\r\n    const min_y = gameBounds.y;\r\n\r\n    const w = 0.2;\r\n\r\n    //Crystal\r\n    const planeMaterial = new THREE.MeshBasicMaterial({\r\n        color: 0xffffff,\r\n        opacity: 0.2,\r\n        transparent: true,\r\n    });\r\n    const planeGeometry = new THREE.PlaneBufferGeometry( gameBounds.width, gameBounds.height, 8, 8 );\r\n\r\n    const crystal = new THREE.Mesh( planeGeometry, planeMaterial );\r\n\r\n    crystal.position.set(min_x, min_y, 10);\r\n    crystal.name = \"NOCOLLIDE_CRYSTAL\";\r\n    scene.add(crystal);\r\n    interactable.push(crystal);\r\n\r\n    createBound(\"TOP_SHELF\",min_x, min_y - w/2 + gameBounds.height / 2, 0, w, gameBounds.width, 100, 0x9c9c9c);\r\n    createBound(\"BOTTOM_SHELF\",min_x, min_y + w/2 - gameBounds.height / 2, 0, w, gameBounds.width*1.1, 100, 0x9c9c9c);\r\n}\r\n\r\nfunction createAndAddShadowPlanes(){\r\n    const createShadowPlane = function (width, height, position, rotation, opacity = 0.5) {\r\n        const planeGeometry = new THREE.PlaneBufferGeometry( width, height, 32, 32 );\r\n        const planeMaterial =  new THREE.ShadowMaterial();\r\n\r\n        planeMaterial.opacity = opacity;\r\n\r\n        const plane = new THREE.Mesh( planeGeometry, planeMaterial );\r\n\r\n        plane.position.copy(position);\r\n        plane.rotation.copy(rotation);\r\n        plane.receiveShadow = true;\r\n\r\n        return plane;\r\n    }\r\n\r\n    const rot = new THREE.Euler(0, 0, 0);\r\n    for(let i = 0; i < planElems.length; i++) {\r\n        const e = planElems[i];\r\n        const b = e.getBoundingClientRect();\r\n\r\n        const pos = getGameXY(b);\r\n\r\n        pos.z = -1;\r\n        const shadowPlane = createShadowPlane(pos.width, pos.height, pos, rot);\r\n        scene.add(shadowPlane);\r\n    }\r\n}\r\n\r\nfunction init() {\r\n    clock = new THREE.Clock();\r\n\r\n    canvas = document.getElementById( 'c' );\r\n\r\n    renderer = new THREE.WebGLRenderer( { canvas: canvas, alpha: true } );\r\n\r\n    renderer.shadowMap.enabled = true;\r\n    renderer.shadowMap.type = THREE.PCFSoftShadowMap; // default THREE.PCFShadowMap\r\n\r\n    camera = new THREE.OrthographicCamera( 0,0,0,0, 1, 2000 );\r\n\r\n    camera.position.z = 100;\r\n    camera.zoom = 100;\r\n\r\n    updateCameraSize();\r\n\r\n    updateCubeSettings();\r\n\r\n    scene = new THREE.Scene();\r\n    scene.add( new THREE.AmbientLight( 0x505050 ) );\r\n\r\n    directionalLight = new THREE.DirectionalLight( 0xffffff, 1 );\r\n    directionalLight.position.set( -2, -5, 30 );\r\n    directionalLight.castShadow = true;\r\n    directionalLight.shadow.camera = camera.clone();\r\n    directionalLight.shadow.camera.near = 30;\r\n    directionalLight.shadow.camera.far = 40;\r\n    directionalLight.shadow.mapSize.width = directionalLight.shadow.mapSize.height = 512;\r\n    scene.add( directionalLight );\r\n\r\n    const lineGeometry = new THREE.BufferGeometry();\r\n\r\n    linePositions = new Float32Array( 2 * 3 ); // 3 vertices per point\r\n    lineGeometry.setAttribute( 'position', new THREE.BufferAttribute( linePositions, 3 ) );\r\n    lineGeometry.setDrawRange( 0, 2 );\r\n\r\n    line = new THREE.Line( lineGeometry,  new THREE.LineBasicMaterial( { color: 0xffffff , linewidth: scaleByPixelRatio(2)}) );\r\n\r\n    scene.add( line );\r\n\r\n    const geometry = new THREE.BoxBufferGeometry( 1, 1, 1 );\r\n\r\n    grabPoint = new THREE.Mesh( new THREE.SphereGeometry( 1, 16, 16 ), new THREE.MeshBasicMaterial( { color: 0xffffff } ) );\r\n    grabPoint.scale.set(0.1, 0.1,0.1);\r\n\r\n    grabPoint.visible = false;\r\n\r\n    scene.add(grabPoint);\r\n\r\n    function createCube(quat, scale, pos, i, mass, textureUrl) {\r\n        const texture = new THREE.TextureLoader().load(textureUrl);\r\n        const object = new THREE.Mesh(geometry, new THREE.MeshBasicMaterial({map: texture}));\r\n\r\n        object.position.set(pos.x, pos.y, pos.z);\r\n        object.scale.set(scale.x, scale.y, scale.z);\r\n        object.quaternion.set(quat.x, quat.y, quat.z, quat.w);\r\n\r\n        let colShape = new CANNON.Box(new CANNON.Vec3(scale.x * 0.5, scale.y * 0.5, scale.z * 0.5));\r\n\r\n        let body = new CANNON.Body({\r\n            mass: mass, // kg\r\n            position: new CANNON.Vec3(pos.x, pos.y, pos.z), // m\r\n            shape: colShape,\r\n            quaternion: quat\r\n        });\r\n        physicsWorld.addBody(body);\r\n\r\n        object.name = \"cube\" + i;\r\n        object.userData.physicsBody = body;\r\n        object.castShadow = true;\r\n\r\n        return object;\r\n    }\r\n\r\n    for ( let i = 0; i < cubeSettings.length; i ++ ) {\r\n        const config = cubeSettings[i] || {pos: undefined, rot: undefined};\r\n\r\n        let pos = config.pos;\r\n        let rot = config.rot || new THREE.Euler(0, 0, 0);\r\n        let scale = {x: 1, y:1, z:1};\r\n        const quat = new THREE.Quaternion();\r\n        let mass = 1;\r\n\r\n        quat.setFromEuler(rot);\r\n\r\n        const size = document.querySelector('.cube').getBoundingClientRect().width / camera.zoom;\r\n\r\n        scale.x = size;\r\n        scale.y = size;\r\n        scale.z = size;\r\n\r\n        if (!pos) {\r\n            pos = {};\r\n            pos.x = -4 + i * (size + .1);\r\n            pos.y = 2;\r\n            pos.z = 0;\r\n        }\r\n\r\n        const object = createCube(quat, scale, pos, i, mass, config.texture);\r\n\r\n        if (!config.active)\r\n            object.userData.physicsBody.sleep();\r\n        object.userData.domElem = config.elem;\r\n\r\n        scene.add(object);\r\n        cubes.push( object );\r\n        interactable.push( object );\r\n    }\r\n\r\n    createAndAddCubesContainer();\r\n\r\n    createAndAddShadowPlanes();\r\n\r\n    window.lastWidth = window.innerWidth;\r\n\r\n    //HACK: Reloads page on resize... Too hard to recreate physics+render worlds u.u\"\r\n    window.addEventListener( 'resize', () => {\r\n        if (window.lastWidth === window.innerWidth){\r\n            updateSize();\r\n            return;\r\n        }\r\n\r\n        if (window.RT) clearTimeout(window.RT);\r\n        window.RT = setTimeout(() => window.location.reload(false), 500);\r\n    }, false );\r\n\r\n    window.addEventListener( 'mousemove', onMouseMove, false );\r\n    window.addEventListener( 'dragstart', onMouseMove, false );\r\n    window.addEventListener( 'mousedown', onMouseDown, {passive: false} );\r\n    window.addEventListener( 'mouseup', onMouseCancel, false );\r\n\r\n    window.addEventListener( 'touchstart', onMouseDown, {passive: false} );\r\n    window.addEventListener( 'touchend', onMouseCancel, false );\r\n    window.addEventListener( 'touchmove', onMouseMove, false );\r\n}\r\n\r\nfunction createBound(name, x, y, z, height, width, depth, color, friction = 1){\r\n    let colShape = new CANNON.Box(new CANNON.Vec3(width/2, height/2, depth/2));\r\n\r\n    let body = new CANNON.Body({\r\n        mass: 0 , //Static\r\n        position: new CANNON.Vec3(x, y, z), // m\r\n        shape: colShape\r\n    });\r\n    physicsWorld.addBody(body);\r\n\r\n    (function() {\r\n        //body.setFriction(friction);\r\n        physicsWorld.addBody(body);\r\n\r\n        const geometry = new THREE.BoxBufferGeometry( 1, 1, 1 );\r\n        const object = new THREE.Mesh( geometry, new THREE.MeshBasicMaterial( { color: color } ) );\r\n\r\n        object.scale.set(width, height, depth);\r\n\r\n        object.position.x = x;\r\n        object.position.y = y;\r\n        object.position.z = z;\r\n\r\n        object.name = name;\r\n        object.userData.body = body;\r\n\r\n        scene.add(object);\r\n    })();\r\n}\r\n\r\nfunction removeEntity (name) {\r\n    const selectedObject = scene.getObjectByName(name);\r\n    if (selectedObject) {\r\n        if (selectedObject.userData.body)\r\n            physicsWorld.removeBody(selectedObject.userData.body);\r\n        scene.remove(selectedObject);\r\n    }\r\n}\r\n\r\nfunction CreateBounds(){\r\n    const min_x = camera.left / camera.zoom;\r\n    const max_x = camera.right / camera.zoom;\r\n    const min_y = camera.bottom / camera.zoom;\r\n    const max_y = camera.top / camera.zoom;\r\n\r\n    let w = 2;\r\n\r\n    removeEntity(\"TOP\");\r\n    removeEntity(\"BOTTOM\");\r\n    removeEntity(\"LEFT\");\r\n    removeEntity(\"RIGHT\");\r\n\r\n    createBound(\"TOP\",min_x - w/2, 0, 0, (max_y - min_y), w, 100, 0xffffff);\r\n    createBound(\"BOTTOM\", max_x + w/2, 0, 0, (max_y - min_y), w, 100, 0x0000ff);\r\n\r\n    createBound(\"LEFT\",0, max_y + w/2, 0, w, (max_x - min_x), 100, 0xff0000);\r\n    createBound(\"RIGHT\",0, min_y - w/2, 0, w, (max_x - min_x), 100, 0x00ff00);\r\n}\r\n\r\nfunction updateCameraSize(){\r\n    camera.left = canvas.clientWidth / - 2;\r\n    camera.right = canvas.clientWidth / 2;\r\n    camera.top = canvas.clientHeight / 2;\r\n    camera.bottom = canvas.clientHeight / - 2;\r\n    camera.updateProjectionMatrix();\r\n}\r\n\r\nfunction resizeRendererToDisplaySize(renderer) {\r\n    const r = renderer.domElement;\r\n    const width  = canvas.clientWidth;\r\n    const height = canvas.clientHeight;\r\n    const needResize = r.width !== width || r.height !== height;\r\n\r\n    if (needResize)\r\n        renderer.setSize(width, height, false);\r\n\r\n    return needResize;\r\n}\r\n\r\nfunction updateSize() {\r\n    if (resizeRendererToDisplaySize(renderer)) {\r\n        updateCubeSettings();\r\n        updateCameraSize();\r\n        CreateBounds();\r\n    }\r\n}\r\n\r\nfunction animate() {\r\n    render();\r\n    requestAnimationFrame( animate );\r\n}\r\n\r\nlet intersection = undefined;\r\nlet constraint;\r\nlet pickedBody;\r\n\r\nconst mousePickClamping = 30;\r\n\r\nfunction onMouseDown( event ) {\r\n    updateMouse(event);\r\n    updateIntersection(mouse);\r\n\r\n    if (!intersection) return;\r\n\r\n    event.preventDefault();\r\n\r\n    const inter = intersection;\r\n    const obj = inter.object;\r\n\r\n    pickedBody = obj.userData.physicsBody;\r\n\r\n    const localPoint = obj.worldToLocal(inter.point)\r\n    const localPivot = new CANNON.Vec3(localPoint.x * obj.scale.x, localPoint.y * obj.scale.y, localPoint.z * obj.scale.z);\r\n    constraint = new CANNON.PointToPointConstraint(pickedBody, localPivot, jointBody, new CANNON.Vec3(), 20);\r\n    physicsWorld.addConstraint(constraint);\r\n\r\n    grabPoint.visible = true;\r\n    grabPoint.position.copy(inter.point);\r\n    grabPoint.parent = obj;\r\n}\r\n\r\nfunction onMouseCancel( event ) {\r\n    if (constraint){\r\n        physicsWorld.removeConstraint(constraint);\r\n        constraint = undefined;\r\n        //pickedBody.setActivationState(1);\r\n        pickedBody = undefined;\r\n        grabPoint.visible = false;\r\n    }\r\n}\r\n\r\nfunction updateMouse(event){\r\n    const touchEv = event.touches && event.touches[0];\r\n    const changedTouchEv = event.changedTouches && event.changedTouches[0];\r\n    const touch = touchEv || changedTouchEv || event;\r\n\r\n    const documentBounds = document.documentElement.getBoundingClientRect();\r\n\r\n    mouse.x = ( touch.pageX / documentBounds.width ) * 2 - 1;\r\n    mouse.y = - ( touch.pageY / documentBounds.height ) * 2 + 1;\r\n\r\n    mouse.nonPageX = ( touch.clientX / documentBounds.width ) * 2 - 1;\r\n    mouse.nonPageY = - ( touch.clientY / documentBounds.height ) * 2 + 1;\r\n}\r\n\r\nfunction updateIntersection(mouse){\r\n    raycaster.setFromCamera( mouse, camera );\r\n\r\n    const newIntersections = raycaster.intersectObjects( interactable );\r\n\r\n    intersection = undefined;\r\n\r\n    if (newIntersections.length > 0 && !newIntersections[0].object.name.startsWith(\"NOCOLLIDE\")){\r\n        intersection = newIntersections[0];\r\n    }\r\n\r\n    if (intersection){\r\n        canvas.style.pointerEvents = 'all';\r\n        canvas.style.cursor = 'pointer';\r\n    }else if (!constraint){\r\n        canvas.style.pointerEvents = 'none';\r\n        canvas.style.cursor = 'auto';\r\n    }\r\n}\r\n\r\nfunction addMouseConstraint(x,y,z,body) {\r\n    // The cannon body constrained by the mouse joint\r\n    constrainedBody = body;\r\n\r\n    // Vector to the clicked point, relative to the body\r\n    var v1 = new CANNON.Vec3(x,y,z).vsub(constrainedBody.position);\r\n\r\n    // Apply anti-quaternion to vector to tranform it into the local body coordinate system\r\n    var antiRot = constrainedBody.quaternion.inverse();\r\n    pivot = antiRot.vmult(v1); // pivot is not in local body coordinates\r\n\r\n    // Move the cannon click marker particle to the click position\r\n    jointBody.position.set(x,y,z);\r\n\r\n    // Create a new constraint\r\n    // The pivot for the jointBody is zero\r\n    mouseConstraint = new CANNON.PointToPointConstraint(constrainedBody, pivot, jointBody, new CANNON.Vec3(0,0,0));\r\n\r\n    // Add the constriant to world\r\n    world.addConstraint(mouseConstraint);\r\n}\r\n\r\nfunction onMouseMove( event ) {\r\n    updateMouse(event);\r\n    updateIntersection(mouse);\r\n\r\n    let v = new THREE.Vector3( mouse.x, mouse.y, -1 )\r\n    let {x, y, z} = v.unproject(camera);\r\n\r\n    jointBody.position.x = x;\r\n    jointBody.position.y = y;\r\n\r\n    if (constraint) {\r\n        constraint.update();\r\n\r\n        canvas.style.cursor = 'move';\r\n\r\n        if (mouse.nonPageY > .8){\r\n            window.scroll(window.scrollX, window.scrollY - 10);\r\n            updateMouse(event);\r\n            updateIntersection(mouse);\r\n        }\r\n    }\r\n}\r\n\r\nlet frame_counter = 0;\r\nlet first_time = true;\r\n\r\nfunction render(){\r\n    const deltaTime = clock.getDelta();\r\n\r\n    const time = Date.now() * 0.0005;\r\n\r\n    directionalLight.position.y = Math.cos( time * 3 ) * .75 - 5;\r\n\r\n    ClampPositions();\r\n\r\n    if (constraint) {\r\n        if (first_time){\r\n            ga('send', {\r\n                hitType: 'event',\r\n                eventCategory: 'LCDM',\r\n                eventAction: 'start'\r\n            });\r\n\r\n            first_time = false;\r\n        }\r\n        let v = new THREE.Vector3( mouse.x, mouse.y, -1 )\r\n        let {x, y, z} = v.unproject(camera);\r\n        let grabPointPos = new THREE.Vector3();\r\n\r\n        grabPointPos.setFromMatrixPosition(grabPoint.matrixWorld);\r\n\r\n        let i = 0;\r\n\r\n        linePositions[i++] = grabPointPos.x;\r\n        linePositions[i++] = grabPointPos.y;\r\n        linePositions[i++] = grabPointPos.z;\r\n\r\n        linePositions[i++] = x;\r\n        linePositions[i++] = y;\r\n        linePositions[i++] = z;\r\n\r\n        line.geometry.attributes.position.needsUpdate = true;\r\n        line.geometry.computeBoundingSphere();\r\n        line.visible = true;\r\n    }else{\r\n        line.visible = false;\r\n    }\r\n\r\n    updatePhysics( deltaTime );\r\n\r\n    if (!solved){\r\n        solved = CheckSolution();\r\n\r\n        if (solved) {\r\n            ga('send', {\r\n                hitType: 'event',\r\n                eventCategory: 'LCDM',\r\n                eventAction: 'solved'\r\n            });\r\n            PlaySolvedMagic();\r\n        }\r\n    }else{\r\n        if (frame_counter++ % 300 === 0) {\r\n            for (let i = 0; i < cubes.length; i++) {\r\n                const body = cubes[i].userData.physicsBody;\r\n                const force = Math.random()*50;\r\n                const v = new THREE.Vector3(Math.random() - 0.5, Math.random() - 0.5, Math.random() - 0.5);\r\n                v.normalize();\r\n                v.multiplyScalar(force);\r\n\r\n                const [vx, vy, vz] = [v.x, v.y, 0];\r\n\r\n                //body.activate();\r\n                body.applyLocalImpulse(v, new CANNON.Vec3(0, 0, 0));\r\n            }\r\n        }\r\n        window.fluidsMovePointers(PreparePointers());\r\n    }\r\n\r\n    renderer.render( scene, camera );\r\n}\r\n\r\nwindow.solve = () => {solved = true; PlaySolvedMagic()};\r\n\r\nlet solved = false;\r\n\r\nfunction PreparePointers(){\r\n    const cubePointers = [];\r\n\r\n    for(let i = 0 ; i < cubes.length; i++){\r\n        const cube = cubes[i];\r\n        const pos = cube.position;\r\n\r\n        cubePointers.push({\r\n            x: (pos.x * camera.zoom + camera.right),\r\n            y: (pos.y * camera.zoom + camera.top),\r\n            identifier: cube.name\r\n        });\r\n    }\r\n\r\n    return cubePointers;\r\n}\r\n\r\nfunction PlaySolvedMagic(){\r\n    removeEntity(\"TOP_SHELF\");\r\n    removeEntity(\"BOTTOM_SHELF\");\r\n    removeEntity(\"NOCOLLIDE_CRYSTAL\");\r\n    window.vantabg.destroy();\r\n    window.enableFluids();\r\n    const cubesPointers = PreparePointers();\r\n    window.fluidsStartPointers(cubesPointers);\r\n    gravity = 0;\r\n}\r\n\r\nfunction CheckSolution(){\r\n    const element = document.querySelector('.puzzle');\r\n    const bounds = element.getBoundingClientRect();\r\n    const gameBounds = getGameXY(bounds);\r\n\r\n    const min_x = gameBounds.x - gameBounds.width / 2;\r\n    const max_x = gameBounds.x + gameBounds.width / 2;\r\n    const min_y = gameBounds.y - gameBounds.height / 2;\r\n    const max_y = gameBounds.y + gameBounds.height / 2;\r\n\r\n    const solution = \"12345\";\r\n    const trySol = [];\r\n\r\n    for(let i = 0 ; i < cubes.length; i++){\r\n        const cube = cubes[i];\r\n\r\n        if (cube.position.x > max_x || cube.position.x < min_x){\r\n            return false;\r\n        }\r\n        if (cube.position.y > max_y || cube.position.y < min_y){\r\n            return false;\r\n        }\r\n        trySol.push([i+1, cube.position.x])\r\n    }\r\n\r\n    trySol.sort((a, b) => a[1] - b[1]);\r\n    const proposedSol = trySol.map((e) => e[0].toString()).join(\"\");\r\n\r\n    return solution === proposedSol;\r\n}\r\n\r\nfunction ClampPositions(){\r\n    for(let i = 0; i < cubes.length; i++){\r\n        const obj = cubes[i];\r\n        const body = obj.userData.physicsBody;\r\n\r\n        const position = obj.position;\r\n\r\n        position.z = 0;\r\n        position.x = Math.min(Math.max(camera.left / camera.zoom, position.x), camera.right / camera.zoom);\r\n        position.y = Math.min(Math.max(camera.bottom / camera.zoom, position.y), camera.top / camera.zoom);\r\n\r\n        body.position.set(position.x, position.y, position.z);\r\n    }\r\n}\r\n\r\nlet gravity = undefined;\r\nlet jointBody = undefined;\r\n\r\nfunction setupPhysicsWorld(){\r\n    if (!gravity)\r\n        gravity = -9.82;\r\n\r\n    physicsWorld = new CANNON.World();\r\n    physicsWorld.quatNormalizeSkip = 0;\r\n    physicsWorld.quatNormalizeFast = false;\r\n\r\n    physicsWorld.broadphase = new CANNON.NaiveBroadphase();\r\n    physicsWorld.allowSleep = true;\r\n    physicsWorld.gravity.set(0, gravity, 0); // m/s\r\n\r\n    jointBody = new CANNON.Body({ mass: 0 });\r\n    physicsWorld.add(jointBody)\r\n}\r\n\r\nfunction start(){\r\n    setupPhysicsWorld();\r\n\r\n    init();\r\n    updateSize();\r\n    CreateBounds();\r\n    animate();\r\n}\r\nconst fixedTimeStep = 1.0 / 60.0; // seconds\r\nconst maxSubSteps = 3;\r\n\r\nfunction updatePhysics( dt ){\r\n    // Update gravity\r\n    physicsWorld.gravity.set(0, gravity, 0)\r\n    // Step world\r\n    physicsWorld.step(fixedTimeStep, dt, maxSubSteps);\r\n\r\n    // Update rigid bodies\r\n    for ( let i = 0; i < cubes.length; i++ ) {\r\n        let objThree = cubes[ i ];\r\n        let body = objThree.userData.physicsBody;\r\n\r\n        let p = body.position;\r\n        let q = body.quaternion;\r\n        objThree.position.set( p.x, p.y, p.z );\r\n        objThree.quaternion.set( q.x, q.y, q.z, q.w );\r\n    }\r\n}\r\n\r\nconst burger = document.querySelector('#navbar-burger-id');\r\n\r\nburger.addEventListener('click', function(){\r\n    if (burger.classList.contains('is-active')){\r\n        gravity = -9.82;\r\n        //for(let i = 0; i < cubes.length; i++)\r\n        //    cubes[i].userData.physicsBody.activate(true);\r\n    }else{\r\n        if (!solved) return;\r\n        gravity = 0;\r\n    }\r\n}, false)\r\n\r\nfunction scaleByPixelRatio (input) {\r\n    let pixelRatio = window.devicePixelRatio || 1;\r\n\r\n    return Math.floor(input * pixelRatio);\r\n}"]}